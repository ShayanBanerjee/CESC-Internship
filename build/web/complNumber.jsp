<%--
    Document   : rb_kchs_entry
    Created on : 7 Jun, 2017, 5:45:58 PM
    Author     : roshni bose
--%>


<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">

    <meta name="author" content="">
<html>
    <head>
        <SCRIPT type='text/javascript' src='datetimepicker_css.js'></SCRIPT>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          <title class="color:#3859DC">Enquiry By Complaint No</title>
<script src="jquery.min.js"></script>

    <jsp:include page="header.jsp" />


    <!--this is one   -->
<style type="text/css">
.css_btn_class {
	font-size:16px;
	font-family:Arial;
	font-weight:normal;
	-moz-border-radius:8px;
	-webkit-border-radius:8px;
	border-radius:8px;
	border:2px solid #e284f3;
	padding:10px 20px;
	text-decoration:none;
	background:-moz-linear-gradient( center top, #f1bdfa 31%, #da80ea 74% );
	background:-ms-linear-gradient( top, #f1bdfa 31%, #da80ea 74% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f1bdfa', endColorstr='#da80ea');
	background:-webkit-gradient( linear, left top, left bottom, color-stop(31%, #f1bdfa), color-stop(74%, #da80ea) );
	background-color:#f1bdfa;
	color:#ffffff;
	display:inline-block;
	text-shadow:1px 2px 0px #b952cc;
 	-webkit-box-shadow:inset 1px 1px 0px 0px #f6dcfb;
 	-moz-box-shadow:inset 1px 1px 0px 0px #f6dcfb;
 	box-shadow:inset 1px 1px 0px 0px #f6dcfb;
}.css_btn_class:hover {
	background:-moz-linear-gradient( center top, #da80ea 31%, #f1bdfa 74% );
	background:-ms-linear-gradient( top, #da80ea 31%, #f1bdfa 74% );
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#da80ea', endColorstr='#f1bdfa');
	background:-webkit-gradient( linear, left top, left bottom, color-stop(31%, #da80ea), color-stop(74%, #f1bdfa) );
	background-color:#da80ea;
}.css_btn_class:active {
	position:relative;
	top:1px;
}
/* This css button was generated by css-button-generator.com */
</style>
    
   <style type="text/css">
<!--
.style1 {
 color: #027001
}
.style2 {

    /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#1e5799+0,7db9e8+100&1+0,0.7+0,1+62,0+100 */
background: -moz-linear-gradient(top, rgba(30,87,153,0.7) 0%, rgba(89,148,202,1) 62%, rgba(125,185,232,0) 100%); /* FF3.6-15 */
background: -webkit-linear-gradient(top, rgba(30,87,153,0.7) 0%,rgba(89,148,202,1) 62%,rgba(125,185,232,0) 100%); /* Chrome10-25,Safari5.1-6 */
background: linear-gradient(to bottom, rgba(30,87,153,0.7) 0%,rgba(89,148,202,1) 62%,rgba(125,185,232,0) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b31e5799', endColorstr='#007db9e8',GradientType=0 ); /* IE6-9 */
    
   }
.style3 {color: #af3d00;font-size: 13.5px;font-family: "Quicksand";font-weight:bold}
-->
td{
    
}
</style>


<script>

function cndf(){
    var df = document.getElementById("df").value;

}

var rb;
function searchCno(cno){


  var url;
		//var val=1;
                
                    if (typeof XMLHttpRequest != "undefined")
                    {
                        rb= new XMLHttpRequest();
                    }
                    else if (window.ActiveXObject)
                    {
                        rb= new ActiveXObject("Microsoft.XMLHTTP");
                    }
                    if (rb==null)
                    {alert("inside if");
                        alert ("Browser does not support XMLHTTP Request")
                        return

                     }
                     if(cno=='' || cno==null || cno==undefined || cno=='null'){
                         return false
                     }
                     //delete the next line for general case
                  // if(val==1){
                  else{
                       var df=document.getElementById("df").value;
                       var srl=document.getElementById("cno").value;
                       var yr=document.getElementById("cyr").value;
                       var cno=df+"-"+srl+"-"+yr;
           
                           url='complNumInter.jsp?flag=1&cno=CN-'+cno;

                    rb.onreadystatechange = stateChangerb;
                    rb.open("GET", url, true);
                    rb.send(null);

                }
               

            }

           function stateChangerb()
            {
                if (rb.readyState==4 || rb.readyState=="complete")
                {

                    document.getElementById("dv_msg").style.display="none"
                    var str=rb.responseText.split("$$_$$")
                   if(str[0].substring(0,1)=="E")
                    {
                        alert(rb.responseText.split("$$_$$")[1])
                        document.getElementById("dv_msg").display="none"
                        return false
                    }
                    var s=rb.responseText.split("$$_$$");
                    document.getElementById("dv_msg").display="none"

                //    alert(s)
                             var ctype=s[2]
                             if(ctype=='1'){
                                 //naps
                                 var napsid=s[0];
                                 document.getElementById("napsid").value=napsid;
                                 var df=napsid.split("-")[0]
                                 var ref=napsid.split("-")[1]
                                 var yr=napsid.split("-")[2]

                                 document.getElementById("mrdst").value=df
                                 document.getElementById("mrref").value=ref
                                 document.getElementById("mryr").value=yr
                             }else if(ctype=='2'){
                                 //technical
                                 document.getElementById("consno").value=s[1];
                             }
                    //         alert(s);
                             
                   document.getElementById("name").innerHTML=s[4];
                   document.getElementById("phone").innerHTML=s[14];
                   document.getElementById("mobile").innerHTML = s[15] + "   (M)";
                   document.getElementById("add1").innerHTML=s[5];
                   document.getElementById("email").innerHTML=s[16];
                   document.getElementById("lpno").innerHTML=s[12];
                   document.getElementById("source").innerHTML=s[22];
                   document.getElementById("supplytype").innerHTML=s[20];
                   document.getElementById("supplymode").innerHTML=s[21];
                   document.getElementById("compltype").innerHTML=s[2];
                   document.getElementById("complcat").innerHTML=s[3];
                   document.getElementById("letterno").innerHTML=s[18];
                   document.getElementById("letterdate").innerHTML=s[23];
                   document.getElementById("refto").innerHTML=s[24];
                   document.getElementById("escto").innerHTML=s[13];
                   document.getElementById("complremarks").innerHTML=s[13];
                   document.getElementById("actdt").innerHTML=s[26];
                   document.getElementById("closermk").innerHTML=s[27];
                   document.getElementById("refremarks").innerHTML = s[28];
                   document.getElementById("docTable").innerHTML =s[29] ;

                  // var ALLOW=s[19];
                   if(s[19]=='1'){
                       document.getElementById("btn_sub").style.display='inline';
                       document.getElementById("btn_sub").disabled=false;
                        document.getElementById("stat").innerHTML="STATUS: <font color=red size=5>PENDING";
                   }else{
           //            alert("This complaint is already attended. No further editing is allowed.")

                       document.getElementById("btn_sub").disabled=true
                       document.getElementById("btn_sub").style.display='none';
                        document.getElementById("stat").innerHTML="STATUS: <font color=green size=5>ATTENDED";
                   }

                }
            }
            /////////////////////////////////////////////////////
            function disableSingleQuote() {//------roshni----------------
                var key = window.event.keyCode;
                if (key ==39){
                    window.event.returnValue = false;
                }
            }
            function onlydigit() {
                var key = window.event.keyCode;
                if (key <48 || key >57){
                    window.event.returnValue = false;
                }
            }
   </script>

    </head>
    <body >
 <%@ page import="java.util.*" %>
        <%@ page import="java.sql.*" %>
        <%@ page import="javax.sql.*" %>
        <%@ page import="oracle.sql.*" %>
        <%@ page import="oracle.jdbc.*" %>

        <%@ page import="KotaChsConnectionPackage.*" %>
   <div id="wrapper">
<%
                MakeConnectionKotaChs mk = new MakeConnectionKotaChs();
                Connection conn = mk.con;
try{

                String suser = (String) session.getAttribute("sessuid"); //user id
		String scat = (String) session.getAttribute("sesscat"); //user category or role
		String soffcd = (String) session.getAttribute("sessoffcd"); // office code
		String susernm = (String) session.getAttribute("sessuname"); //Name of the user
                String subsuser = (String) soffcd.substring(0, 4);
                String complNum = request.getParameter("complNum");
                String[] cnArr =new String[3];

                if(complNum!=null){
                 cnArr = complNum.split("-");
                }

    //            suser="adm-a1";
    //            soffcd="2107210";
%>
<form name="form1"  method="post">

<jsp:include page="navbar.jsp?suser=<%=suser%>&soffcd=<%=soffcd%>" />
        <!-- Page Content -->
        <div id="page-wrapper" style="/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#e2e2e2+0,d1d1d1+46,dbdbdb+58,fefefe+100 */
background: rgb(226,226,226); /* Old browsers */
background: -moz-linear-gradient(top, rgba(226,226,226,1) 0%, rgba(209,209,209,1) 46%, rgba(219,219,219,1) 58%, rgba(254,254,254,1) 100%); /* FF3.6-15 */
background: -webkit-linear-gradient(top, rgba(226,226,226,1) 0%,rgba(209,209,209,1) 46%,rgba(219,219,219,1) 58%,rgba(254,254,254,1) 100%); /* Chrome10-25,Safari5.1-6 */
background: linear-gradient(to bottom, rgba(226,226,226,1) 0%,rgba(209,209,209,1) 46%,rgba(219,219,219,1) 58%,rgba(254,254,254,1) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e2e2e2', endColorstr='#fefefe',GradientType=0 ); /* IE6-9 */">
           <div class="row">
                <div class="col-lg-12" align="center">
                 <input type="hidden" name="napsid" id="napsid"  />
                 <input type="hidden" name="ecd" id="ecd" value="<%=suser%>" />
                 <input type="hidden" name="ofcd" id="ofcd" value="<%= soffcd%>" />
                     <span class="style3"> <font size="4" color="#250e8e">ENQUIRY BY COMPLAINT NUMBER</font>
                     </span>
                </div>



        <%
                    String sysdt="",mdist="";
                    String sql = "select to_char(sysdate,'dd/mm/yyyy') from dual";
                    Statement sst = conn.createStatement();
                    ResultSet srs = sst.executeQuery(sql);
                    srs.next();
                    sysdt = srs.getString(1);
                    srs.close();
                    sst.close();

        %>
                <!-- /.col-lg-12 -->
            </div>
           <div>
                  <center><br>
              <table align="center" width="100%" cellpadding="1" cellspacing="0" style="border:0px "
                                       border="2"   bordercolor="#ffffff" >
                   <tr style="/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#e4f5fc+0,bfe8f9+50,9fd8ef+51,2ab0ed+100;Blue+Gloss+%235 */
background: rgb(228,245,252); /* Old browsers */
color:indigo;
background: -moz-linear-gradient(top, rgba(228,245,252,1) 0%, rgba(191,232,249,1) 50%, rgba(159,216,239,1) 51%, rgba(42,176,237,1) 100%); /* FF3.6-15 */
background: -webkit-linear-gradient(top, rgba(228,245,252,1) 0%,rgba(191,232,249,1) 50%,rgba(159,216,239,1) 51%,rgba(42,176,237,1) 100%); /* Chrome10-25,Safari5.1-6 */
background: linear-gradient(to bottom, rgba(228,245,252,1) 0%,rgba(191,232,249,1) 50%,rgba(159,216,239,1) 51%,rgba(42,176,237,1) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e4f5fc', endColorstr='#2ab0ed',GradientType=0 ); /* IE6-9 */">
                    <th ALIGN="RIGHT" colspan="3"><span >&nbsp;&nbsp;Enter Complaint Number :</span> &nbsp;</th>
<!--                  <td   colspan="4" align="center"><b>
                       &nbsp;&nbsp;&nbsp;&nbsp; CN - <!-- <input type="text" id="df" maxlength='8' size=5 readonly name="df" value="<%=soffcd%>"  onkeypress="onlydigit();" /> -
  -->
                     <%
                     
%>
     <!--                  <input type="text" id="df" maxlength='8' size=5  name="df" value="<%=cnArr[1]%>"  onkeypress="onlydigit();" /> -
         -->

                 <td colspan="2" class="style1">  CN -
                  <select class="" name="complaint type" id="df" onchange="cndf()">
                      <%  if(complNum!=null){ %>
                      <option value="<%=cnArr[1] %>" selected><%=cnArr[1] %></option>
                        <%
                        }
                            String sqlCode="select code from anc.ANC_OFFICE_DETAILS where code like '"+subsuser+"%'";
                            Statement st3=conn.createStatement();
                            ResultSet rs3=st3.executeQuery(sqlCode);
                            while(rs3.next())
                            {

                               %>
                               <option value=<%=subsuser+rs3.getString(1).substring(4, 7)%>><%=subsuser+rs3.getString(1).substring(4, 7)%></option>
                               <%
                            }
                            rs3.close();
                            st3.close();
                         %>
                        </select>
                   

<!-- upto this-->
                       <%
                      if(complNum!=null){
%>
                       <input type="text" id="cno" maxlength='5' size=5  name="cno" value="<%=cnArr[2]%>" title="enter 5 digit Complaint Number"  onkeypress="onlydigit();" /> -
                        <%}else{
               %>
                       <input type="text" id="cno" maxlength='5' size=5  name="cno"  title="enter 5 digit Complaint Number"  onkeypress="onlydigit();" /> -
                        <%         
                        }                        
%>

<%
                      if(complNum!=null){
%>
                 <input type="text" id="cyr" maxlength='2' size=1  name="cyr" value="<%=cnArr[3]%>" title="enter 2 digit Complaint Number Year"  onkeypress="onlydigit();" />
                                 <%}else{
               %>
                   <input type="text" id="cyr" maxlength='2' size=1  name="cyr" title="enter 2 digit Complaint Number Year"  onkeypress="onlydigit();" />
                           <%
                        }
%>
                         &nbsp;&nbsp;  <input type="button"  id="btn_src" name="btn_src" value="Search"  onclick="searchCno('1');" class="css_btn_class"/>
                         &nbsp;&nbsp;&nbsp;<input type="button"  class="css_btn_class" id="btn_rest" name="btn_rest" value="Reset"  onclick="location.reload();window.open('complNumber.jsp#home');" />&nbsp;&nbsp;
                                      
                    </td>
                    </tr>



                <tr style="">
                    
                 
                </tr>
                <tr>
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Name </span></th>
                    <td colspan="2" valign="top" rowspan="1"><div id="name" class="style3">&nbsp;&nbsp;</div></td>
                
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Phone Number:</span></th>
                    <td colspan="2" valign="middel">
                        <div id="phone" class="style3">                         
                        </div><br>
                        <div id="mobile" class="style3"></div>
                      </td>
                </tr>
                <tr>
                    <th ALIGN="RIGHT" rowspan="2"><span class="style1">&nbsp;&nbsp;Address </span> &nbsp;</th>
                    <td colspan="2" valign="top" rowspan="2">
                        <br>
                        <div id="add1"  cols=32 rows="3" name="add1" class="style3" >&nbsp;&nbsp;</div><br>
                           </td>
                    <th ALIGN="RIGHT"><span class="style1">&nbsp;&nbsp;Email</span>&nbsp;</th>
                    <td colspan="2" valign="middle">
                        <div id="email"  name="email" class="style3">&nbsp;&nbsp;</div>
                    </td>
                </tr>
                <tr>
                    <th ALIGN="RIGHT"><span class="style1">&nbsp;&nbsp;L/P No: </span>&nbsp;</th>
                    <td colspan="2" valign="middle"><div type="text" id="lpno"  name="lpno" class="style3">&nbsp;&nbsp;</div></td>
                    
                    
                </tr>
                 <tr>
                    <th ALIGN="RIGHT"><span class="style1">&nbsp;&nbsp;Source</span>&nbsp;</th>
                    <td colspan="2" valign="middle"><div id="source" name="source" class="style3">&nbsp;&nbsp;</div></td>
                </tr>
                <tr>
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Supply Type</span></th>
                    <td colspan="2" valign="middle"><div id="supplytype" class="style3">&nbsp;&nbsp;</div></td>
                    <th ALIGN="RIGHT"><span class="style1" class="style3"> &nbsp;&nbsp;Supply Mode</span></th>
                    <td colspan="2" valign="middle"><div id="supplymode" class="style3">&nbsp;&nbsp;</div></td>
                </tr>
                <tr>
                   <th height="30" ALIGN="RIGHT" width="20%"  ><span class="style1"> &nbsp;&nbsp;Complaint Type</span> &nbsp;</th>
                   <td height="30" width="15%" colspan="2" valign="middle"><div id="compltype" class="style3">&nbsp;&nbsp;</div>
                    </td>
                    <th height="30" ALIGN="RIGHT" width="15%">
                        <span class="style1"> &nbsp;&nbsp;Complaint Category *</span> &nbsp;</th>
                    <td width="20%" colspan="2" valign="middle">
                        <div style="display:inline"  id="complcat" class="style3"> &nbsp;&nbsp;</div>
                    </td>
                 </tr>
                <tr>
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Letter No</span> &nbsp;</th>
                    <td colspan="2" valign="middle"><div id="letterno" class="style3">&nbsp;&nbsp;</div></td>
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp; Letter Date</span> &nbsp;</th>
                    <td colspan="2" valign="middle"><div id="letterdate" class="style3">&nbsp;&nbsp;</div></td>
                </tr>
                <tr>
                    <th ALIGN="RIGHT">&nbsp;<span class="style1"> &nbsp;Complainant's Remarks </span>&nbsp;</th>
                    <td colspan="5" valign="middle">
                        <div name="complremarks" id="complremarks" cols="120" rows="2" class="style3">&nbsp;&nbsp;</div>
                    </td>
                </tr>
                
                <tr>
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Refered to</span> &nbsp;</th>
                    <td colspan="2" valign="middle"><div id="refto" class="style3">&nbsp;&nbsp;</div></td>
                    <th ALIGN="RIGHT">&nbsp;<span class="style1"> &nbsp;&nbsp;Referring Remarks </span>&nbsp;</th>
                     <td colspan="5" valign="middle">
                        <div name="refremarks" id="refremarks" cols="120" rows="2" class="style3">&nbsp;&nbsp;</div>
                    </td>
                </tr>


                <tr>     
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Escalated To</span> &nbsp;</th>
                    <td colspan="2" valign="middle"><div id="escto" class="style3">&nbsp;&nbsp;</div></td>
                </tr>

                 <tr style="">
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;  Action Date:</span> &nbsp;</th>
                    <td colspan="2" valign="middle"><div type="text" id="actdt"  name="actdt" class="style3">&nbsp;&nbsp;</div></td>
                    <th ALIGN="RIGHT"><span class="style1"> &nbsp;&nbsp;Closing Remarks</span> &nbsp;</th>
                    <td colspan="2" valign="middle"> <div type="text" name="closermk" id="closermk" class="style3">&nbsp;&nbsp;</div></td>

                </tr>
            </table>

                        <!--     this is inserted....remove if incompatible -->
           <div class="panel-body">
        <div class="row" >
           <div class="panel panel-default">
               <div class="panel-heading" style="color:darkcyan">
                    Document(s) Provided
               </div>
                           <div class="panel-body">
                                <div class="table-responsive" id="tabledet">
                                    <table id="upl_docs" class="table table-striped table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>#</th>                                               
                                                <th align="center">Document Name</th>                                               
                                                <th align="center">Uploaded On</th>                                            
                                            </tr>

                                        </thead>
                                        <tbody>

                                        </tbody>
                                    </table>
                                    
                                   <div id="docTable">

                                   </div>
                                    
                                </div>
                            </div>
            </div>
                        

                            </center>
         </div>
                        <div id="dv_msg" style="display:none;top:250px;z-index: 50;left:50%; position: fixed;width:100%">
                            <img src="loading3.gif"  width="270" height="280"/>
                        </div>


    </div>
        <!-- /#page-wrapper -->

        <script>
            searchCno('<%=complNum%>');
            </script>
    </form>

    </div>
</div>
    <!-- /#wrapper -->

    <jsp:include page="footer.jsp" />
<%

}catch(Exception e){
    out.print(e);
    }
                finally{
                    conn.close();
                    mk.con.close();
                    }
%>

</body>

</html>

